# Fully Convolutional Networks for Semantic Segmentation

# 備考

## 著者
Jonathan Long, Evan Shelhamer, Trevor Darrell

## 掲載

InProceedings of the IEEE Conference on Computer Vision and Pattern Recogni-tion, pages 3431–3440, 2015.

# Abstract

畳み込みネットワークは、特徴の階層を生成する強力な視覚モデルである。本研究では、畳み込みネットワークは、それ自体で、end-to-end で、ピクセルからピクセルへと学習され、セマンティックセグメンテーションの最先端技術を上回ることを示す。 我々の重要な洞察は、任意のサイズの入力を受け取り、効率的な推論と学習で対応するサイズの出力を生成する「完全畳み込み」ネットワークを構築することである。 我々は、完全畳み込みネットワークの空間を定義し、詳細に説明し、空間的に密な予測タスクへの適用を説明し、先行モデルとの関連を描く。現代の分類ネットワーク（AlexNet [20]、VGG net [31]、GoogLeNet [32]）を完全畳み込みネットワークに適応させ、それらの学習された表現を微調整[3]することでセグメンテーションタスクに移行させる。そして、深い粗い層からの意味情報と、浅くて細かい層からの外観情報を組み合わせて、正確で詳細なセグメンテーションを生成するスキップアーキテクチャを定義する。我々の完全畳み込みネットワークは、PASCAL VOC（2012年の平均IUが62.2%と20%の相対的な改善）、NYUDv2、およびSIFT Flowの最先端のセグメンテーションを達成する一方で、推論は典型的な画像の場合は5分の1秒以下で済む。

# Introduction

畳み込みネットワークが認識の進歩を牽引している。畳み込みネットワークは，画像全体の分類 [20, 31, 32] のためだけでなく，構造化された出力を持つ高精度のタスクでも進歩を遂げている．これには，箱型物体検出 [29, 10, 17]，部分およびキーポイント予測 [39, 24]，局所対応 [24, 8] の進歩が含まれる．

粗い推論から細かい推論へと進む際の自然な次のステップは、各ピクセルで予測を行うことです。 これまでのアプローチでは、セマンティックセグメンテーション[27, 2, 7, 28, 15, 13, 9]に畳み込みネットワークを使用していましたが、この論文では、各ピクセルに囲まれたオブジェクトや領域のクラスをラベル付けしています。

我々は、セマンティックセグメンテーションにおいて、エンドツーエンドでピクセルからピクセルへと学習された完全畳み込みネットワーク(FCN)が、これ以上の機械を使わずに最先端の技術を上回ることを示す。 我々の知る限りでは、これがFCNをエンドツーエンドで学習させ(1)ピクセル単位の予測と(2)スーパービジュアライズされた事前学習からの予測をさせた初めての研究である。 既存のネットワークの完全畳み込み版は、任意のサイズの入力から高密度の出力を予測する。学習と推論は、高密度フィードフォワード計算とバックプロパゲーションにより、画像全体で一度に実行される。ネットワーク内のアップサンプリング層により、サブサンプリングされたプーリングを持つネットでのピクセル単位の予測と学習が可能になります。

この方法は、漸近的にも絶対的にも効率的であり、他の研究での複雑さを排除している。 パッチワイズトレーニングは一般的であるが [27, 2, 7, 28, 9]，完全畳み込みトレーニングの効率性に劣っている．我々のアプローチは、スーパーピクセル[7, 15]、提案[15, 13]、ランダムフィールドや局所分類器[7, 15]によるポストホックな絞り込みなどの前後処理の複雑さを利用しない。  我々のモデルは、分類ネットを完全畳み込み型として再解釈し、学習した表現から微調整することで、最近の分類[20, 31, 32]の成功を密な予測に反映させている。 これとは対照的に，これまでの研究では，教師付きの事前学習を行わずに小さな畳み込みネットを適用していた[7, 28, 27]．

セマンティックセグメンテーションは、セマンティクスと位置情報の間に固有の緊張関係に直面している：グローバル情報は何を解決し、ローカル情報はどこを解決するのか。 深い特徴階層は、非線形なローカルからグローバルへのピラミッドの中に位置情報と意味論を符号化する。 我々は、セクション4.2で、深くて粗い意味情報と浅くて細かい外観情報を組み合わせたこの特徴スペクトルを利用するためのスキップアーキテクチャを定義している（図3参照）。

次のセクションでは、ディープクラスシフィケーションネット、FCN、およびコンベネットを用いたセマンティクスセグメンテーションへの最近のアプローチに関する研究をレビューする。  次の節では、FCNの設計と緻密な予測のトレードオフを明らかにし、ネットワーク内アップサンプリングと多層の組み合わせを用いたアーキテクチャを紹介し、実験的なフレームワークについて述べる。  最後に、PASCAL VOC 2011-2, NYUDv2, SIFT Flowでの最新の結果を示す。

# 2. Related woek

我々のアプローチは、画像分類のためのディープネット[20, 31, 32]と転移学習[3, 38]の最近の成功を利用している。 転移学習は、最初に様々な視覚認識タスク[3, 38]で実証され、次に検出、そしてハイブリッド提案分類器モデル[10, 15, 13]におけるインスタンスとセマンティックセグメンテーションの両方で実証されました。我々は今、意味的セグメンテーションの直接的で密な予測のために、分類ネットを再設計し、微調整している。 我々はFCNの空間を図示し、過去のモデルと最近のモデルの両方をこのフレームワークの中に位置づける。

## Fully convolutional networks

我々の知る限りでは、コンブネットを任意のサイズの入力に拡張するというアイデアが最初に登場したのはMatanら[26]であり、彼は古典的なLeNet[21]を拡張して桁の文字列を認識するようにした。彼らのネットは一次元の入力文字列に限定されていたため、Matanetらは出力を得るためにビタビ復号化を使用した。Wolf and Platt[37]は、 convnetの出力を、郵便物の住所ブロックの四隅の検出スコアの2次元マップに拡張している。これらの歴史的な研究はいずれも検出のために推論と学習的に畳み込み処理を行っている。 Ningら[27]は、完全畳み込み推論によるC.elegans組織の粗い多クラスセグメンテーションのための convnetを定義している。

完全畳み込み計算は、多層ネットの時代にも利用されている。  Sermanetら[29]によるスライディングウィンドウ検出、Pinheiro and Collobertら[28]による意味的セグメンテーション、Eigenら[4]による画像復元などが完全畳み込み推論を行っている。完全畳み込み学習は稀であるが，Tompsonら[35]は，この方法についての発表や分析はしていないが，ポーズ推定のためのエンドツーエンド部分検出器と空間モデルを学習するために効果的に使用している．

また、Heら[17]は、特徴抽出器を作成するために、分類ネットの非畳み込み部分を破棄しています。彼らは、提案と空間ピラミッドプーリングを組み合わせて、分類のための局所的な固定長の特徴を生成しています。このハイブリッドモデルは、高速で効果的ですが、エンドツーエンドで学習することはできません。

## Dense prediction with convnets

最近では、Ningら[27]、Farabetら[7]、Pinheiro and Collobertら[28]による意味的セグメンテーション、Ciresanら[2]による電子顕微鏡の境界予測、Ganinら[9]による自然画像の境界予測、Eigenら[4,5]による画像の復元と深度推定など、いくつかの研究があります。これらのアプローチに共通する要素は以下の通りです.

* 容量と受容領域を制限した小型モデル
* パッチワイズトレーニング [27, 2, 7, 28, 9]
* スーパーピクセル投影、ランダムフィールド正則化、フィルタリング、局所分類による後処理 [7, 2, 9] [7, 2, 9]
* 密な出力のための入力シフトと出力の組み合わせ [29,28,9]
* マルチスケールピラミッド処理 [7, 28, 9]
* 飽和非線形性 [7, 4, 28]
* アンサンブル(集合) [2, 9]

我々の手法はこのような機械を使わずに学習を行う．しかし，我々はFCNの観点から パッチワイズ・トレーニング (第3.4節)と "シフト・アンド・スティッチ"による密出力 (第3.2節)を研究している． また，ネットワーク内アップサンプリング(第3.3節)についても議論するが，Eigenら[5]の完全接続予測は特殊なケースである．

これらの既存の手法とは異なり、我々は、画像分類を教師付き事前学習として使用して、深層分類アーキテクチャを適応させ、拡張し、完全に畳み込み的に微調整して、全体の画像入力と全体の画像基底スラスから簡単かつ効率的に学習することができます。

これらの既存の手法とは異なり、我々は、画像分類を教師付き事前学習として使用して、深層分類アーキテクチャを適応させ、拡張し、完全に畳み込み的に微調整して、全体の画像入力とグランドトゥルースから簡単かつ効率的に学習することができます。

我々は、レイヤー間の特徴を融合させ、非線形なローカルからグローバルへの表現を定義し、それをエンドツーエンドで調整します。  最近の研究では、Hariharanら[16]もハイブリッドモデルで複数のレイヤーを使用してセマンティックセグメンテーションを行っている。

# 3. 