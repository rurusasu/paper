# Representing Attitude: Euler Angles, Unit Quaternions, and RotationVectors

# Abst

3次元空間における剛体の姿勢を表現するための3つの主要な数学的構成要素を紹介します。これらは、(1)回転行列、(2)オイラー角の3重構造、(3)単位四元数です。これに4つ目の回転ベクトルを加えると、オイラー角と四元数の多くの利点がありますが、オイラー角の特異性や四元数の制約はありません。この他にも、ケイリークラインパラメータや軸角表現など、いくつかの補助的な表現があり、これらの表現と3つの主要な表現との関係についても説明します。ここでの説明は、このテーマ全体についての完全で統一された参考文献を求める人のためのものであり、いくつかの結果の詳細な導出は示されていない。

# 1. Intro

本書は，3次元空間における物体の姿勢をパラメータ化することをテーマとした，統一的なリファレンスとして作成されたものである。これは、既存のオンライン文献のギャップを埋めるために書かれたものです。特に、オイラー角と四元数のテーマについては、多くのウェブページやテクニカルレポートがありますが、一貫した詳細で統一された取り扱いで、すべてのトピックをカバーする単一のリファレンスを見つけることができませんでした。 この問題は、現在使用されている数多くの慣習や、著者が自分の選択を明示せずに特定の慣習を仮定したり、代替案についてコメントしない傾向があることで、さらに悪化しています。 さらに、既存のオンライン文献では、3つのオイラー角の様々な可能な選択肢の分野で特に大きなギャップがあります。

剛体の姿勢を表す最も一般的な方法は、3つのオイラー角の組み合わせです。オイラー角は、わかりやすく、使いやすいので人気があります。オイラー角の中には、飛行機のロール、ピッチ、ヨーのように、一般に広く使われている名称がある。オイラー角の主な欠点は次のとおりである。
(1)オイラー角の重要な関数には特異点があること
(2)姿勢の時間的変化を積分する際に単位四元数よりも精度が低いこと
です。

このようなオイラー角表現の欠点から、剛体の姿勢のパラメータ化には単位四元数が用いられている。単位四元数の関連関数には特異点がなく、この表現は物体の角速度を時間的に積分するのに適している。単位四元数の主な欠点は以下の通りです。
(1)四元数が直感的な物理的意味を持たないこと
(2)四元数が純粋な回転であるためにはユニティノルムを持たなければならないこと
姿勢パラメータを最適化に含める場合、二次形式であるユニティノルム制約は特に問題となりますが、ほとんどの標準的な最適化アルゴリズムはこのような制約を符号化できないからです。

オイラー角や単位四元数に代わるものとして、回転ベクトルがあります。回転ベクトルは、オイラー角の特異性と単位四元数の二次的制約の両方を欠いています。これは新しいパラメータ化ではありませんが、このテーマに関する既存の文献には詳細が不足していることがわかりました。回転ベクトルは、慎重に設計してもオイラー角の特異点を回避できない場合に、姿勢パラメータを最適化しようとする場合に特に有効です。それ以外の状況では最良の選択ではないかもしれません。

## 1.1. コンテンツの概要

1.3節では、本レポートで使用されている座標系を定義しています。2章では、回転行列の概念を紹介し、その重要な特性を説明します。第3章では、剛体運動学を紹介します。5章では、オイラー角について、最も一般的に使用されている3つの慣用法の詳細を含め、その多様性について説明しています。第6章では、四元数、特に単位四元数と軸角の表現について説明します。7章では、回転ベクトルを四元数の3次元パラメタライズとして説明します。最後に，8章では12種類のオイラー角のパラメータ化のカタログを示す。 本報告書では，必要に応じて，様々な表現方法の間の変換や，使用方法や命名規則に関する説明を行っている。

## 1.2. Sources

本報告書の数学的結果は、基本的な定義と第一原理から導き出されたものです。結果を確認するために、また、さまざまな規則の使用に関する情報を提供するために、いくつかの資料を使用しました。オイラー角については、[1] および [4] を参照しています。Caley-Kleinパラメータについては，[3] を参照しています．四元数と Euler-Rodrigues パラメータについては、[5] と [2] を、特に後者を引用します。キネマティクスについては、[1] を参照しています。

## 1.3. 座標系

2つの異なる座標系で表現されたデータの関係を考えます。
* ワールド座標系は、慣性空間に固定されています。
* この座標系の原点を $x_w$ とする。体固定座標系は、姿勢を表現したい物体に固く固定されています。この座標系の原点を $x_b$ とする。

体内固定座標で表現された点やベクトルは，世界座標で表現されたものとは素数記号で区別される。 例えば，$x$ が世界座標上の点であるならば，$x′$ は体部固定座標上で表現された同じ点である。言うまでもなく，$x_w$ と $x′_b$ はともにゼロであるが，$x′_w$ と $x_b$は一般的にはゼロではない。ここで，$x′_w$ は体側固定座標で表された世界座標の原点であり，$x_b$ は世界座標で表された体内固定座標の原点である。

このドキュメントで説明されている数学の一部は、世界座標系が回転固定の場合にのみ適用されます。しかし、多くの目的では、角速度がゼロではないにもかかわらず、地球に取り付けられた座標系のようにゆっくりと回転する座標系を有効な世界座標系とみなすことはまったく問題ありません。

# 2. 回転行列

回転行列とは，ベクトルとの掛け算で，その長さを保ったままベクトルを回転させる行列のことである。すべての3×3回転行列の特別な直交群を $SO(3)$ と呼ぶ。したがって、$R \in SO(3)$ の場合は

$$
\det{R} = \pm1  R^{−1} = R^T.
$$

$\det{R}=1$ の回転行列を *proper*と呼び、$\det{R}=-1$ の回転行列を *inproper* と呼ぶ。不適切な回転は *rotoinversions* とも呼ばれ、回転の後に反転操作が行われます。不適切な回転は剛体変換ではないので、ここでは適切な回転に限定して分析する。

回転行列の要素を以下のように参照する。
$$
R = \left[
  \begin{array}{ccc}
    \bm{r}_1 & \bm{r}_2 & \bm{r}_3
  \end{array}
  \right] \\
$$
$$
 = \left[ \begin{array}{ccc}
    r_{11} & r_{12} & r_{13} \\
    r_{21} & r_{22} & r_{23} \\
    r_{31} & r_{32} & r_{33}
   \end{array} \right]
$$

剛体の姿勢を表す回転行列の定義には2つの方法があり、現在はどちらも使用されています体内固定座標からワールド座標に対応する行列を書きたいという人もいれば、ワールド座標から体内固定座標に対応する行列を書きたいという人もいます。

この2つの表記法の変換は，行列の転置を行うのと同じくらい簡単なことですが，2つの表記法の結果を一緒に使う前に，2つの異なる表記法が同じ表記法であることを確認する必要があります。実際，このレポートの動機の1つは，このテーマ全体をカバーする1つの一貫したリファレンスを提供することです。

## 2.1. 座標変換

剛体の姿勢を符号化する回転行列 $R$ を、世界座標で表されたベクトルに前置乗算すると、体内固定座標で表された同じベクトルが得られる行列と定義する。すなわち，$\bm{z} \in \mathbb{R}^3$ を世界座標で表されたベクトルとし，$\bm{z}′ \in \mathbb{R}^3$ を身体固定座標で表された同じベクトルとすると，次のような関係が成り立つ。

$$
\bm{z}' = R \bm{z}
$$
$$
\bm{z} = R^T \bm{z}'
$$

これらの表現は、空間内の位置を欠く相対的な量であるベクトルに適用される。 ある点をある座標系から他の座標系に変換するには、回転行列を適用する前に、対象となる座標系の原点へのオフセットを差し引かなければならない。したがって、$\bm{x} \in \mathbb{R}^3$ が世界座標上の点であり、$\bm{x}′ \in \mathbb{R}^3$ が体内固定座標で表された同じ点である場合、次のように書くことができます。

$$
\bm{x}' = R(\bm{x}-\bm{x}_b) = R\bm{x} + \bm{x}'_w
$$
$$
\bm{x} = R^T(\bm{x}' - \bm{x}_w') = R^T\bm{x}' + \bm{x}_b
$$

式6に $\bm{x} = 0$ を、式7に $\bm{x}' = 0$ を代入すると、次のようになります。

$$
\bm{x}_w' = -R\bm{x}_b
$$
$$
\bm{x}_b = -R^T\bm{x}_w'
$$

## 2.2. 変換行列

コンピュータグラフィックスの世界では、式（6）と式（7）を行列-ベクトル積として記述することがよくあります。

$$
\left[
  \begin{array}{c}
    \bm{x}' \\ 1
  \end{array}
\right] =
\left[
  \begin{array}{cc}
    R & \bm{x}_w' \\
    \bm{0}^T & 1
  \end{array}
\right]
\left[
  \begin{array}{c}
    \bm{x} \\
    1
  \end{array}
\right]
=\left[
  \begin{array}{cc}
    R & -R \bm{x}_b \\
    \bm{0}^T & 1
  \end{array}
\right]
\left[
  \begin{array}{c}
    \bm{x} \\
    1
  \end{array}
\right]
$$

$$
\left[
  \begin{array}{c}
    \bm{x} \\ 1
  \end{array}
\right] =
\left[
  \begin{array}{cc}
    R^T & \bm{x}_b \\
    \bm{0}^T & 1
  \end{array}
\right]
\left[
  \begin{array}{c}
    \bm{x}' \\
    1
  \end{array}
\right]
=\left[
  \begin{array}{cc}
    R^T & -R^T \bm{x}_w' \\
    \bm{0}^T & 1
  \end{array}
\right]
\left[
  \begin{array}{c}
    \bm{x'} \\
    1
  \end{array}
\right]
$$

この方式は、3Dアクセラレーション対応のハードウェアメーカーが採用していることもあり、かなり普及しています。


## 2.3. 剛体の姿勢

剛体のポーズとは、その剛体の位置と姿勢のことである。このレポートの大部分は姿勢のパラメータ化を扱っている。位置は、世界座標で表現された体内固定座標の原点の位置である $x_b$によって最も自然に符号化される。 しかし、体の固定座標で表現された世界座標の原点の位置である $x_w'$を格納することも同様に有効である。 この2つは、式8と式9により、剛体の姿勢を介して互いに関連している。

## 2.4. 座標軸の回転

座標回転とは、一つの座標軸を中心とした回転のことである。$X$軸、$Y$軸、$Z$軸を1、2、3と列挙すると、$i \in {1,2,3}$ に対する座標回転 $Ri:R \rightarrow SO(3)$ は、次のようになる。

$$
R_1(\alpha) =
\left[
  \begin{array}{ccc}
    1 & 0 & 0 \\
    0 & \cos(\alpha) & \sin(\alpha) \\
    0 & -\sin(\alpha) & \cos(\alpha)
  \end{array}
\right]
$$
$$
R_2(\alpha) =
\left[
  \begin{array}{ccc}
    \cos(\alpha) & 0 & -\sin(\alpha) \\
    0 & 1 & 0 \\
    \sin(\alpha) & 0 & \cos(\alpha)
  \end{array}
\right]
$$
$$
R_3(\alpha) =
\left[
  \begin{array}{ccc}
    \cos(\alpha) & \sin(\alpha) & 0 \\
    -\sin(\alpha) & \cos(\alpha) & 0 \\
    0 & 0 & 1
  \end{array}
\right]
$$

この形式の回転の例を図1に示します。これは、z軸を中心に角度 $\alpha$ だけ回転させたものです。

![fig1](https://raw.githubusercontent.com/rurusasu/paper/master/AI%E6%8A%80%E8%A1%93/AI%E6%8A%80%E8%A1%93%E5%BF%9C%E7%94%A8/%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/Representing%20Attitude%20Euler%20Angles%2C%20Unit%20Quaternions%2C%20and%20RotationVectors/%E7%94%BB%E5%83%8F/fig1.png)
図1：z軸を中心に角度αだけ回転させた座標の例。

# 方向性 cos 行列

回転行列は、体の固定軸とワールド軸の間の符号なしの角度の余弦を要素としているので、方向余弦行列とも呼ばれる。ワールド軸を $(x, y, z)$、体内固定軸を $(x′, y′, z′)$ とすると、例えば、$x′$ 軸と $y$ 軸の間の符号なしの角度を $\theta_{x′,y}$ とする。これらの角度に関して、回転行列は次のように書くことができる。

$$
R =
\left[
  \begin{array}{ccc}
    \cos(\theta_{x', x}) & \cos(\theta_{x', y}) & \cos(\theta_{x', z}) \\
    \cos(\theta_{y', x}) & cos(\theta_{y', y}) & \cos(\theta_{y', z}) \\
    cos(\theta_{z', x}) & \cos(\theta_{z', y}) & \cos(\theta_{z', z})
  \end{array}
\right]
$$

これを具体的な例で説明すると、図1に示すようなケースを考えます。ここで、$\theta_{x′,x} ＝ \theta_{y′,y} ＝ \alpha、\theta_{x′,y} ＝ \frac{\pi}{2} - \alpha、\theta_{y′,x} ＝ \frac{\pi}{2} ＋ \alpha、\theta_{z′,z} ＝ 0、\theta_{z′,{x,y}} ＝ \theta_{\{x′,y′\},z} ＝ \frac{\pi}{2}$ である。式(17)を展開すると

$$
R =
\left[
  \begin{array}{ccc}
    \cos(\theta_{x', x}) & \cos(\theta_{x', y}) & 0 \\
    \cos(\theta_{y', x}) & \cos(\theta_{y', y}) & 0 \\
    0 & 0 & 1
  \end{array}
\right]
$$

$$
=\left[
  \begin{array}{ccc}
    \cos(\alpha) & \cos(\frac{\pi}{2} - \alpha) & 0 \\
    \cos(\frac{\pi}{2} + \alpha) & \cos(\alpha) & 0 \\
    0 & 0 & 1
  \end{array}
\right]
$$

$$
=\left[
  \begin{array}{ccc}
    \cos(\alpha) & \sin(\alpha) & 0 \\
    -\sin(\alpha) & \cos(\alpha) & 0 \\
    0 & 0 & 1
  \end{array}
\right]
$$

これは、2.4節のEq.16と同じ結果です。

## 2.6. 基底ベクトル

回転行列は、ワールド座標系と体内固定座標系を定義する基底ベクトルの行列と考えることもできる。回転行列の行は、ワールド座標で表現された体内固定座標の基底ベクトルであり、列は、身体固定座標で表現されたワールド座標の基底ベクトルである。

## 2.7. 回転行列の乗算

2つの回転行列を掛け合わせると、別の回転行列が得られます。この回転行列を点に適用すると、元の2つの回転行列を連続して適用した場合と同じ回転が得られます。例えば、次のようにします。

$$
\bm{z}' = R_a \bm{z}
$$
$$
\bm{z}'' = R_{b/a} \bm{z}' = R_{b/a} R_a \bm{z} = R_b \bm{z}
$$
ここで
$$
R_b = R_{b/a} R_a
$$

なお、回転は逆の順序で行われます。つまり、ここでは $R_a$ を最初に適用し、次に $R_{b/a}$ を適用します。

# 3. 運動学

運動学とは、粒子や剛体の運動を、力やモーメントの有無にかかわらず研究する学問です。つまり、3次元空間の性質を研究する学問であり、少なくとも部分的には本報告書の範囲に含まれるものである。 このセクションでは、いくつかの重要な結果を導出せずに提示します。

# 5. オイラー角
## 5.1. 回転シーケンス

3つの座標回転を連続して行うことで、任意の回転を記述することができる。ここでは、1回目の回転が $k$ 軸を中心とした角度 $\psi$、2回目の回転が $j$ 軸を中心とした角度 $\theta$、3回目の回転が $i$ 軸を中心とした角度 $\phi$ となる3回の回転を考えてみよう。 表記を簡潔にするために、これらの角度をオイラー角ベクトルと呼ばれる3次元のベクトルに整理すると、次のように定義される。

$$
\bm{u} \ratio =
  \left[
    \begin{array}{ccc}
      \phi, & \theta, & \psi
    \end{array}
  \right]^T
$$

オイラー角のベクトルと、それに対応する回転行列 $R_{ijk} \ratio \mathbb{R}^3 \rightarrow SO(3)$ を対応させる関数は

$$
R_{ijk}(\phi, \theta, \psi) \ratio= R_i(\phi)R_j(\theta)R_k(\psi)
$$

一般の場合と同様に、$z \in \mathbb{R}^3$ を世界座標で表したベクトルとし、$z′ \in \mathbb{R}^3$ を同じベクトルを体内固定座標で表した場合、以下の関係が成り立ちます。

$$
\bm{z}' = R_{ijk}(\bm{u})z
$$
$$
\bm{z} = R_{ijk}(\bm{u})^T \bm{z}'
$$

## 5.2. オイラー角速度と角速度

このオイラー角ベクトルの時間微分がオイラー角速度のベクトルである。オイラー角速度と物体の角速度との関係は、オイラー角速度行列に格納されている。この行列にオイラー角速度のベクトルを掛けると、グローバル座標での角速度が得られる。$\hat{e}_i$を $i$ 番目の単位ベクトルとすると、オイラー角ベクトルとそれに対応するオイラー角速度行列 $E:R^3 \rightarrow \mathbb{R}^{3 \times 3}$ を対応させる関数は

$$
E_{ijk}(\phi, \theta, \psi) \ratio=
\left[
  \begin{array}{ccc}
    R_k(\phi)^T R_j(\theta)^T\hat{\bm{e}}_i, & R_k(\psi)^T\hat{\bm{e}}_j, & \hat{\bm{e}}_k
  \end{array}
\right]
$$

となり、関連する共役オイラー角速度行列関数 $E':R^3 \rightarrow \mathbb{R}^{3 \times 3}$ は、オイラー角速度のベクトルとの乗算により、体固定角速度は

$$
E'_{ijk} (\phi, \theta, \psi) \ratio =
\left[
  \begin{array}{cc}
    \hat{\bm{e}}_i, & R_i(\phi)\hat{\bm{e}}_j, & R_i(\phi)R_j(\theta)\hat{\bm{e}}_k
  \end{array}
\right]
$$
ゆえに
$$
\omega = E_{ijk}(\bm{u})\dot{\bm{u}}
$$
$$
\omega' = E'_ijk(\bm{u})\dot{\bm{u}}
$$

また、体内固定座標での角速度は、グローバル座標での角速度と次のように関連していることに注意してください。

$$
\omega' = R_{ijk}(\bm{u})\omega
$$
$$
\omega = R_{ijk}(\bm{u})^T \omega'
$$

$\omega$, $omega'$, $\dot{\bm{u}}$ を消去すると、次のようになります。

$$
R_{ijk}(\bm{u}) = E'_{ijk}(\bm{u})\left[E_{ijk}(\bm{u})\right]^{-1}
$$
$$
R_{ijk}(\bm{u})^T = E_{ijk}(\bm{u})\left[E'_{ijk}(\bm{u})\right]^{-1}
$$

## 5.3. 線形化

多くのアプリケーションは一次方程式を必要とします。オイラー角の関数は、サインやコサインなどの三角関数に依存しています。そのため、これらの関数の線形化されたバージョンを考慮することは有用です。

ここでは、ゼロに対して線形化する場合を考えます。この文脈では、線形化には代入が必要です。

$$
\cos(\alpha) \rightarrow 1
$$
$$
\sin(\alpha) \rightarrow \alpha
$$

高次の項はゼロに設定されます。これらの代入は、αの値が小さい場合に有効です。 図2は，これらの近似値の相対誤差を入力角度の関数として示したものである。サインの近似値は角度 14$^\circ$ で1％の相対誤差が生じ、コサインの近似値は角度 8.2$^\circ$ で同じ誤差が生じている。一般的に、これらの近似値は10$^\circ$ 以下の角度で有効であると考えられる。

例えば、関数 $R_{ijk}(\bm{u})$ の線形化バージョンは $L\{R_{ijk}(\bm{u})\}$ である。Sec. 8 では、いくつかの重要な関数の線形化バージョンを、各有効な回転列の説明に含めている。

ゼロ以外の姿勢に対する線形化は、固定姿勢に対する小さな摂動を考慮することで最も簡単に行うことができる。線形化したいオイラー角のセットを $\bm{u}_0$ とし、摂動角のベクトルを $\bm{u}$ とする。次のように書きます。

$$
R_{\bm{u}_0}(\bm{u}) = L
\left\{
  R_{ijk}(\bm{u})
\right\}
 R_{ijk}(\bm{u}_0)
$$

ここでは、2つの回転行列の積が $\bm{u}$ のパラメータに対して線形になるように、$\bm{u}_0$ を一定と考えています。

## 5.4. 有効な回転順序

ここまでの説明では，どのような座標回転の列が，すべての3次元回転の空間にまたがることができるのかを明らかにしていない．実際，{1,2,3}の3つの整数からなる27個の可能な配列のうち，「有効な配列の中で連続する2つの数字が等しくなることはない」という制約を満たすものは12個しかありません。これらは

$$
(i, j, k) \in
  \begin{array}{c}
    \{ (1, 2, 1), (1, 2, 3), (1, 3, 1), (1, 3, 2), \\
    (2, 1, 2), (2, 1, 3), (2, 3, 1), (2, 3, 2), \\
    (3, 1, 2), (3, 1, 3), (3, 2, 1), (3, 2, 3) \}
  \end{array}
$$

太字の(1,2,3)、(3,1,3)、(3,2,3)の3つが最も一般的な選択である。これら3つの規約は表3で対比されており、最初の2つについては現在検討中です。

## 5.5. オイラー角の配列

### 5.5.1. 使用方法

18世紀のスイスの数学者・物理学者であるレオンハルト・オイラーにちなんで名付けられたオイラー角（3,1,3）という名前に関連する最も一般的な配列。同じ名前を持つ他の伝統的表現と区別するために、x-convention とも呼ばれています。

回転している剛体のジャイロ運動の研究では、オイラー角 $\phi, \theta, \psi$ をそれぞれスピン、ニューテーション、歳差運動と呼んでいる。

ジャイロ運動の一般的な例として、回転するコマがある。 この場合、体に固定されたZ軸はこまの回転軸と一致し、体に固定されたX軸とY軸はこまの側面を指している。世界のZ軸から離れたコマの傾きを回転角といい、この傾きから生じるモーメントによって、おなじみの「歳差運動」と呼ばれるゆっくりとした公転運動が生じます。

### 5.5.2. オイラー角⇒回転行列

この章以降では、コンパクトに表記するために、 $c_\theta := \cos(\theta)$、$s_\phi := \sin(\phi)$ などと表記します。オイラー角のベクトルをその回転行列に対応させる関数と、その同じ関数を線形化したものが

$$
R_{313} (\phi, \theta, \psi) = R_3(\phi)R_1(\theta)R_3(\psi)
$$
$$
= \left[
  \begin{array}{ccc}
    c_\phi c_\psi - s_\phi c_\theta s_\psi & c_\phi  s_\psi + s_\phi c_\theta c_\psi & s_\phi s_\theta \\
    -s_\phi c_\phi - c_\phi c_\theta s_\psi & -s_\phi s_\psi + c_\phi c_\theta c_\psi & c_\phi s_\theta \\
    s_\theta s_\psi & -s_\theta c_\psi & c_\theta
  \end{array}
\right]
$$

$$
L\{R_{313}(\phi, \theta, \psi)\}=
\left[
  \begin{array}{ccc}
    1 & \psi + \phi & 0 \\
    -\phi - \psi & 1 & \theta \\
    0 & -\theta & 1
  \end{array}
\right]
$$

回転行列のオイラー角に対する導関数は

$$
\frac{\partial R_{313}}{\partial \phi} =
\left[
  \begin{array}{ccc}
    -s_\phi c_\psi - c_\phi c_\theta s_\psi & -s_\phi s_\psi + c_\phi c_\theta c_\psi & c_\phi c_\theta \\
    -c_\phi c_\psi + s_\phi c_\theta s_\psi & -c_\phi s_\psi - s_\phi c_\theta c_\phi & -s_\phi s_\theta \\
    0 & 0 & 0
  \end{array}
\right]
$$
$$
\frac{\partial R_{313}}{\partial \phi} =
\left[
  \begin{array}{ccc}
    s_\phi s_\theta s_\psi & -s_\phi s_\theta c_\psi & s_\phi c_\theta \\
    c_\phi s_\theta s_\psi & -c_\phi s_\theta c_\psi & c_\phi c_\theta \\
    c_\theta s_\psi & -c_\theta c_\psi & -s_\theta
  \end{array}
\right]
$$
$$
\frac{\partial R_{313}}{\partial \psi} =
\left[
  \begin{array}{ccc}
    -c_\phi s_\psi - s_\phi c_\theta c_\psi & c_\phi c_\psi - s_\phi c_\theta s_\psi & 0 \\
    s_\phi s_\psi + c_\phi c_\theta c_\psi & -s_\phi c_\psi - c_\phi c_\theta s_\phi & 0 \\
    s_\theta c_\psi & s_\theta s_\psi & 0
  \end{array}
\right]
$$

