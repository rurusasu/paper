# PV-RCNN Point-Voxel Feature Set Abstraction for 3D Object Detection


# Abst

我々は、点群から正確な3Dオブジェクトを検出するための、PointVoxel-RCNN（PV-RCNN）と名付けられた新規かつ高性能な3Dオブジェクト検出フレームワークを提案する。我々の提案する手法は、3Dボクセル畳み込みニューラルネットワーク（CNN）とPointNetベースのセット抽象化の両方を深く統合し、より識別性の高い点群の特徴を学習します。 この手法は、3DボクセルCNNの効率的な学習と高品質な提案、およびPointNetベースのネットワークの柔軟な受容野の利点を活かしている。具体的には、提案フレームワークは、3DボクセルCNNによる3Dシーンを、新しいボクセルセット抽象化モジュールを介して小さなキーポイントのセットに要約し、後続の計算を節約するとともに、代表的なシーンの特徴をエンコードします。ボクセルCNNによって生成された高品質な3Dプロポーザルがあれば、複数の受容野を持つキーポイントセットの抽象化を介して、プロポーザル固有の特徴をキーポイントからRoI-グリッドポイントに抽象化するRoIgridプーリングが提案される。従来のプーリング操作と比較して、RoI-grid特徴点は、オブジェクトの信頼性と位置を正確に推定するためのより豊かなコンテキスト情報を符号化します。KITTIデータセットとWaymo Openデータセットの両方を用いた広範な実験により、我々の提案するPV-RCNNは、点群のみを用いた最先端の3D検出手法を顕著なマージンで上回ることが示された。

# 1. 緒言

3次元物体の検出は、自律走行やロボットなどの様々な分野で応用されており、産業界や学術界から注目を集めています。LiDARセンサーは、3次元シーンの情報を不規則な点群として捉えることができるため、自律走行車やロボットに広く採用されています。本論文では、不規則な点群からより良い3D特徴を学習するために、新しい点-ボクセル統合ネットワークを設計することで、高性能な3D物体検出を実現することを提案します。

既存の3D検出手法の多くは，点群の表現方法の観点から，グリッドベースの手法とポイントベースの手法の2つに分類される。グリッドベースの手法は、一般的に、不規則な点群を3Dボクセル[27, 41, 34, 2, 26]や2Dバードビューマップ[1, 11, 36, 17, 35, 12, 16]などの規則的な表現に変換し、3Dまたは2Dの畳み込みニューラルネットワーク(CNN)で効率的に処理して、3D検出のための点の特徴を学習します。ポイントベースの手法 [22, 25, 32, 37] は、先駆的な研究である PointNet とその改良版 [23, 24] を基に、生の点群から直接、3D 検知のための識別的な特徴を抽出します。一般的に、グリッドベースの手法は計算効率が高いが、情報の損失が避けられないため、きめ細かな定位精度が低下する。一方、ポイントベースの手法は計算コストが高いが、ポイントセットを抽象化することで、より大きな受容野を容易に実現できる[24]。しかし，我々は，統一されたフレームワークが2種類の手法の最良の部分を統合し，先行する最先端の3D検出手法を顕著なマージンで凌駕できることを示した．

我々は、ポイントベースとボクセルベースの特徴学習法の両方の利点を取り入れることで、3D検出性能を向上させる新しい3Dオブジェクト検出フレームワーク、PVRCNN（図1に図示）を提案する。PV-RCNNの原理は、ボクセルベースの操作がマルチスケールの特徴表現を効率的にエンコードし、高品質の3D提案を生成できることにあり、一方、PointNetベースのセット抽象化操作は、柔軟な受容野を持つ正確な位置情報を保持します。我々は、この2種類の特徴学習フレームワークを統合することで、より識別性の高い特徴を学習することができ、正確で細かいボックスの絞り込みが可能になると主張する。

主な課題は、スパース・コンボリューションを用いた3DボクセルCNN [6, 5]をはじめとする2種類の特徴量学習方式をいかに効果的に組み合わせるかということです。とPointNetベースの集合抽象化[24]の2種類の特徴学習方式を、統一された 統一されたフレームワークになります。直感的な解決策は、各3Dプロポーザル内のいくつかのグリッドポイントを一様にサンプリングし、セット抽象化を採用して セットの抽象化を利用して、これらのグリッドポイントを囲む3Dボクセル単位の特徴を集約し、提案を改良することができます。しかし、この方法は、ボクセル数と提案数の両方が多いため、非常にメモリを消費します。ボクセル数と格子点の数の両方が非常に大きくなる可能性があるため しかし、この手法は、ボクセル数と格子点の数が非常に多いため、メモリを大量に消費します。

そこで、これら2種類の点群特徴量学習ネットワークをよりよく統合するために、第1のボクセルからキーポイントへのシーンエンコーディングステップと、第2のキーポイントからグリッドへのRoI特徴量の抽象化ステップの2ステップ戦略を提案する。具体的には、ボクセル単位での特徴学習と正確な提案生成のために、3Dスパースコンボリューションを用いたボクセルCNNを採用しています。シーン全体をエンコードするためには、あまりにも多くのボクセルを必要とするという上述の問題を軽減するために、ボクセル単位の特徴から全体の3D情報を要約するために、最遠点サンプリング（FPS）によって小さなキーポイントのセットが選択されます。各キーポイントの特徴は、マルチスケールの点群情報を要約するために、PointNetベースのセット抽象化を介して隣接するボクセル単位の特徴をグループ化することで集約される。このようにして、少数のキーポイントとそれに関連するマルチスケールの特徴によって、全体的なシーンを効果的かつ効率的にエンコードすることができる。

ここでは、複数の半径を持つキーポイントセット抽象化レイヤーが各グリッドポイントに採用され、マルチスケールコンテキストを持つキーポイントから特徴を集約します。そして、すべての格子点の集約された特徴は、後続の提案の改良に共同で使用することができます。我々の提案するPV-RCNは、ポイントベースのネットワークとボクセルベースのネットワークの両方の利点を効果的に活用し、各ボックス提案において識別的な特徴を符号化することで、正確な信頼性予測ときめ細かなボックスの微調整を可能にしている。

我々の貢献は次の4つに要約される。(1) PV-RCNNフレームワークを提案し、ボクセルベースの手法とポイントベースの手法の両方を効果的に利用して3D点群特徴の学習を行うことで、管理可能なメモリ消費量で3D物体検出の性能を向上させる。(2) ボクセルセット抽象化層により、シーン全体のマルチスケールのボクセル特徴を小さなキーポイントセットにエンコードする、ボクセル-キーポイントシーンエンコード方式を提案する。このキーポイント特徴は、正確な位置を保持するだけでなく、豊富なシーンコンテキストをエンコードすることで、3D検出性能を大幅に向上させることができる。(3) 各提案のグリッドポイントに対して、マルチスケールのRoI特徴抽象化層を提案する。これにより、シーンからのリッチなコンテキスト情報を複数の受容野で集約し、正確なボックスの絞り込みと信頼度の予測を行う。(4) 提案手法であるPV-RCNNは、競合性の高いKITTI 3D検出ベンチマーク[10]において、これまでのすべての手法を顕著なマージンで凌駕し、1位を獲得しました。

# 2. Related Work

## 3D Object Detection with Grid-based Methods.

点群の不規則なデータフォーマットに対処するため、既存のほとんどの作品は点群を規則的なグリッドに投影し、2Dまたは3D CNNで処理している。先駆的な作品であるMV3D [1]では、点群を2Dバードビューグリッドに投影し、3Dバウンディングボックスを生成するために多くの定義済み3Dアンカーを配置していますが、その後の作品[11, 17, 16]では、マルチセンサーフュージョンのための優れた戦略を開発し、[36, 35, 12]では、バードビュー表現を用いたより効率的なフレームワークを提案しています。 他のいくつかの研究[27, 41]では、点群を3D CNNで処理するために3Dボクセルに分割し、3Dボクセルを効率的に処理するために3Dスパース・コンボリューション[5]を導入している[34]。また，[30, 42]では複数の検出ヘッドを利用し，[26]では性能向上のために物体部分の位置を探索しています．これらのグリッドベースの手法は、正確な3Dプロポーザルを生成するためには一般的に効率的ですが、受容野は2D3D畳み込みのカーネルサイズによって制約を受けます。

## 3D Object Detection with Point-based Methods.

FPointNet [22]は、2D画像のバウンディングボックスに基づいて、切り取られた点群から3D検出を行うために、PointNet [23, 24]を適用することを最初に提案しています。PointRCNN [25]は、点群のみを用いた3D検出のために、2D画像の代わりに点群全体から直接3D提案を生成し、次の作業STD [37]は、より良い提案の絞り込みのために、疎から密への戦略を提案しています。また、「STD」[37]では、より良い提案を行うために、疎から密への戦略を提案し、「21」では、より良い物体特徴のグループ化のために、ハフ投票戦略を提案している。これらの点ベースの手法は、ほとんどがPointNetシリーズに基づいており、特に集合抽象化操作[24]は、点群特徴学習のための柔軟な受容場を可能にします。

## Representation Learning on Point Clouds.

近年，点群の分類やセグメンテーションの性能を向上させるために，点群に対する表現学習が注目されている[23, 24, 41, 31, 7, 38, 15, 28, 33, 8, 29, 3]．3D検出に関しては、これまでの手法では、点群を通常の鳥瞰図グリッド[1, 36]や3Dボクセル[41, 2]に投影し、2D3D CNNで点群を処理するのが一般的でした。3Dスパースコンボリューション[6, 5]は、点群からボクセル単位のスパースな特徴を効果的に学習するために[34, 26]で採用されている。Qiら[23, 24]は、生の点群から点単位の特徴を直接学習するPointNetを提案しており、セットの抽象化操作により、異なる探索半径を設定することで柔軟な受容野を実現している。[19]は、ボクセルベースのCNNとポイントベースのSharedMLPの両方を組み合わせて、効率的な点群特徴学習を行っています。これに比べて、我々の提案するPVRCNNは、ボクセルベースの特徴学習（すなわち、3D ボクセルベースの特徴量学習（3Dスパースコンボリューション）とポイントネットベースの特徴量学習（3Dスパースコンボリューション）の両方の利点を利用しています。特徴量の学習（3Dスパースコンボリューション）とPointNetベースの特徴量の学習（セット抽象化演算）の両方の利点を活かして 高品質な3Dプロポーザル生成と柔軟な受容野を実現し、3D検出性能を向上させます。

# 3. PV-RCNN for Point Cloud Object Detection

本論文では、点群からより正確な3Dオブジェクトの検出を目指す2段階の3D検出フレームワークであるPointVoxel-RCNN（PVRCNN）を提案する。 最新の3D検出アプローチは、スパース・コンボリューションを用いた3DボクセルCNN、またはPointNetベースのネットワークをバックボーンとして使用している。一般的に、スパース・コンボリューションを用いた3DボクセルCNNはより効率的で[34, 26]、高品質な3Dオブジェクト・プロポーザルを生成することができ、一方、PointNetベースの手法は柔軟な受容野により、より正確なコンテキスト情報を捉えることができる。

PV-RCNは、2種類のネットワークの長所を深く融合させたものである。図2に示すように、PV-RCNNは、特徴量のエンコードと提案の生成を効率的に行うためのバックボーンとして、スパース・コンボリューションを備えた3DボクセルCNNで構成されている。すなわち、シーン全体の特徴量のすべてのボクセルを少数の特徴量のキーポイントに要約する「ボクセルからキーポイントへのシーンエンコーディング」と、提案の信頼性予測と位置の精密化のためにシーンキーポイントの特徴量をRoIグリッドに効果的に集約する「ポイントからグリッドへのRoI特徴量の抽象化」である。

## 3.1. 3D Voxel CNN for Efficient Feature Encoding and Proposal Generation

3Dスパースコンボリューションを用いたボクセルCNN[6, 5, 34, 26]は、点群をスパースな3D特徴量に効率的に変換するために、最先端の3D検出器でよく使われています。その効率性と精度の高さから、特徴量のエンコードと3Dプロポーザル生成のフレームワークのバックボーンとして採用しています。