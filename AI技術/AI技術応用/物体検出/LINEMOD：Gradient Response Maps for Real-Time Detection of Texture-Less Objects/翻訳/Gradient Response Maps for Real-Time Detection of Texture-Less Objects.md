# Gradient Response Maps for Real-Time Detection of Texture-Less Objects

# 備考

## 著者

## 掲載

## テクスチャとは

3D グラフィック・ソフトなどで使う、物体の表面や質感を表現するための地紋やパターン、または画像のこと。たとえば、3D グラフィックスで造形した建物の表面に、コンクリートや金属、木材の画像を貼り付けて、リアルな質感を出す。また、人体のボディに皮膚と顔の写真を合成して、人間の 3D 映像を作成したりする。テクスチャーを貼り付けることをテクスチャーマッピングという。

# Abstract

本研究では、時間のかかる訓練段階を必要とせず、テクスチャの無いオブジェクトを扱うことができるリアルタイム 3D オブジェクトインスタンス検出手法を提案する。我々のアプローチの核となるのは、テンプレートマッチングのための新しい画像表現であり、小さな画像変換にもロバストであるように設計されている。このロバスト性は広がりのある画像のグラデーション方向に基づいており、画像を解析する際に可能なすべてのピクセル位置のうちの小さなサブセットのみをテストし、限られたテンプレートセットで 3D オブジェクトを表現することを可能にする。さらに、密な深度センサが利用可能であれば、3 次元表面の法線方向も考慮に入れて、より良い性能を得るためにアプローチを拡張できることを示す。我々は、リアルタイムで何千ものテンプレートを考慮するために使用できる入力画像の効率的でありながら非常に識別力のある表現を構築するために、現代のコンピュータのアーキテクチャを活用する方法を示す。我々は、実データを用いた多くの実験で、我々の手法が現在の最先端の手法よりもはるかに高速であり、背景のクラッタに関してより破壊的であることを実証している。

# Introduction

リアルタイム物体インスタンス検出と学習は、コンピュータビジョンにおける重要な課題である。この分野で開発が進められている応用の中で、特にロボット工学は、変化する未知の環境に適応し、新しい物体を学習して認識しなければならないため、計算効率の高いアプローチが強く求められている。

このような時間的に重要なアプリケーションでは、多数の訓練サンプルを必要とし、リアルタイム性能には計算量が多すぎる統計的学習手法とは対照的に、新しいオブジェクトをオンラインで簡単に学習してマッチングすることができるため、リアルタイムテンプレートマッチングは魅力的なソリューションである[1], [2], [3], [4], [5]。このような非効率性の理由は，これらの学習手法は，事前に知っているオブジェクトインスタンスを複数の視点から検出するのではなく，特定のオブジェクトクラスから未見のオブジェクトを検出することを目的としているためである．これは、一般化をオブジェクトクラスではなく、視点サンプリングで行う古典的なテンプレートマッチングで実現しようとしている。この方がより簡単な作業であると考えられるが、学習と実行の間に視点、照明、オクルージョンが大きく変化しているため、簡単な問題ではない。

オブジェクトが十分なテクスチャを持っており、その外観に基づいてキーポイントを見つけ、認識することができる場合、この困難さは、素早く計算してオブジェクトを特徴付けるために使用できるパッチ記述子を定義することによって解決される[6]。しかし、図１のように投影された輪郭によって外観が支配されているようなテクスチャレスの物体では、この種のアプローチは失敗すると考えられる。

![図1]()

この問題を克服するために、我々は、テンプレートの構築とマッチングを高速に行うことができる 3D オブジェクトインスタンスのリアルタイムテンプレート認識に基づく新しいアプローチを提案する。これにより、信頼性の高いリアルタイム認識を維持しつつ、新しいテンプレートをデータベースに追加するだけで、新しいオブジェクトを学習することが非常に簡単かつ事実上容易になることを示す。

しかし、統計的手法の効率性と堅牢性は維持したいと考えています。そこで、我々は、局所的な画像統計量を保持し、高速に計算できる新しい画像表現を提案する。この表現は、テンプレートの小さな移動や変形に対して不変であるように設計されており、これは同一物体の異なる視点への一般化に重要な要素であることが示されている[6]。

我々のアプローチは、画像とその勾配のみを考慮してオブジェクトを検出する、最近の効率的なテンプレートマッチング方法[7]、[8]に関連しています。 そのため、オブジェクトが特徴点の手法を使用するのに十分なテクスチャではない場合でも機能し、新しいオブジェクトを事実上瞬時に学習します。 さらに、オブジェクトのポーズの大まかな推定を直接提供できます。これは、環境と相互作用する必要のあるロボットにとって特に重要です。 ただし、従来のテンプレートマッチング手法[9]、[10]、[11]、[12]と同様に、図 1 に示すような強い背景クラッターが存在すると、パフォーマンスが大幅に低下したり、障害が発生したりします。

そこで，我々はこの問題を解決するために，より大きなテンプレートに対してより高速でありながらも，この問題を解決する新しいアプローチを提案する．[7]のように支配的な方向のみを考慮して小さな変形や移動に対してテンプレートを不変にするのではなく、同様の不変特性を持つ入力画像の再表現を構築しますが、局所的な画像近傍のすべての勾配方向を考慮します。これにより、図 1 に示すように、背景の勾配が強すぎることによる問題を防ぐことができます。

このより細かい方法を使用するときに検出が遅くなるのを避けるために、最新の CPU がどのように機能するかについて慎重に検討する必要があります。 単純な実装では、多くの「メモリキャッシュミス」が発生し、計算が遅くなります。したがって、これらを防止し、さらに重い SSE 並列化を活用するために、メモリ内の画像表現を構造化する方法を示します。 これは重要な貢献であると考えています。ハードウェアの改善の性質上、レガシーコードが新しいバージョンの CPU でより高速に実行されることは保証されていません[13]。 これは、アルゴリズムが計算コストが高いことが多いコンピュータビジョンに特に当てはまります。 現在、CPU アーキテクチャを考慮する必要がありますが、これは簡単な作業ではありません。

高密度深度センサーが利用可能な場合、追加の深度データを使用して、2D 画像勾配と 3D 表面標準の情報を同時に活用することにより、堅牢性をさらに高める方法の拡張について説明します。 密な深度マップからリアルタイムで 3D 表面法線をロバストに計算し、等高線を含む深度の不連続性を維持し、センサーの離散化ノイズを平滑化する方法を提案します。 次に、3D 法線は、画像の勾配と同様に使用されます。

この論文の残りの部分では、アプローチを説明する前に、まず関連する作業について説明します。 次に、アプローチの理論的な複雑さについて説明します。最後に、挑戦的なシーンの実験と定量的評価を示します。

# RELATED WORK

テンプレートマッチングは、長年にわたり、検出による追跡アプリケーションにおいて重要な役割を果たしてきました。これは、そのシンプルさと、さまざまなタイプのオブジェクトを扱うことができるためです。大規模な訓練セットや時間のかかる訓練段階を必要とせず、例えば特徴点ベースの手法では検出が困難な、質感の低いオブジェクトや質感のないオブジェクトを扱うことができます[6], [14]。残念なことに、このような頑強さの増大は、しばしば計算負荷の増大を代償にして、リアルタイムアプリケーションに適したテンプレートマッチングを行うことができません。これまでいくつかの研究では、この複雑さを軽減する試みがなされてきました。

テンプレートマッチング[12]とその拡張[11]の初期のアプローチには、テンプレートと入力画像の輪郭間の面取り距離を非類似度の尺度として使用することが含まれています。例えば、Gavrila と Philomin[11]は、2 値エッジ画像の距離変換上で Chamfer Matching[9]を使用して、形状とパラメータ空間の粗から細へのアプローチを導入しました。面取りマッチングは、エッジポイントの 2 つのセット間の一般化された距離を最小化します。距離変換（DT）を使用する場合は高速ですが、面取り変換の欠点は、しばしばオクルージョンの結果として生じる外れ値に敏感であることです。

2 値エッジ画像におけるもう 1 つの一般的な測定値は，ハウズドルフ距離[15]である．これは，画像内の各エッジ点からテンプレート内の最近傍までの距離の最大値を測定します．しかし，オクルージョンやクラッタの影響に敏感です．Huttenlocher ら[10]は，画像とモデルのエッジ間の距離の最大値の k 番目と，モデルと画像のエッジ間の距離の最大値の l 番目のみを計算する一般化されたハウズドルフ距離を導入することで，この問題を回避しようとした．これにより，この手法は，ある割合のオクルージョンやクラッタに対してロバストなものとなります．残念ながら、画像中の背景クラッタを事前に推定する必要がありますが、常に利用できるとは限りません。さらに、ハウズドルフ距離の計算には計算コストがかかり、多数のテンプレートが使用されている場合にはリアルタイムでの適用ができません。

面取りマッチングもハウズドルフ分散も、エッジ点の向きを考慮するように簡単に修正することができます。これにより、[12]で示されたように、偽陽性の数が大幅に減少しますが、残念ながら計算負荷も増加します。

[16]も距離変換に基づいていますが，どのような場合でも，縮尺変化に不変であり，実時間マッチングを行うのに十分な平面透視歪みに対してロバストであると言えます．残念なことに，それは常に利用できるとは限らない閉じた輪郭を持つ物体に限定されています．

これらの手法はいずれも，例えば Canny 検出器[17]を用いた輪郭抽出アルゴリズムで得られた二値エッジ画像を用いており，照明の変化，ノイズ，ボケに対して非常に敏感である．例えば、画像のコントラストを下げると、抽出されたエッジ画素の数が徐々に減少し、オクルージョン量を増やすのと同じ効果が得られる。

[18]で提案されている方法は、画像の輪郭とは対照的に画像の勾配を考慮することで、このような限界を克服しようとしている。この手法では，テンプレート勾配と画像内の勾配との間の類似性の尺度として，ドット積に依存している．残念ながら、この測定値は、オブジェクトの位置までの距離や、オブジェクトの外観が少しでも歪んでいる場合には、急速に減少します。その結果、外観の変化に対応するためには、類似度測定値を高密度に、かつ多くのテンプレートで評価する必要があり、この方法は計算コストが高くなります。イメージピラミッドを使用することで速度が向上しますが、スケール空間を慎重にサンプリングしないと、微細ではありますが重要な構造が失われてしまう傾向があります。

上記の方法とは逆に、一般的な視覚認識問題に対処するアプローチもあります：それらは統計的学習に基づいており、オブジェクトのカテゴリを検出するのではなく、事前に知っているオブジェクトのインスタンスを目的としています。それらは、カテゴリの一般化に優れていますが、通常、学習と実行時にははるかに遅く、オンラインアプリケーションには適していません。

例えば、Amit ら[19]は、局所的な近傍に勾配方向を広げる coars-to-fine アプローチを提案している。拡散量は初期段階で物体部分ごとに学習される。このアプローチは、ナンバープレートの読み取りに用いられ、高い認識率を実現しているが、リアルタイム性はない。

Histogram of Gradients (HoG) [1]も関連しており、非常によく使われている手法です。これは、画像の局所的な部分における強度勾配の分布を統計的に記述します。この手法は、一様な間隔を持つ密なグリッド上で計算され、より良いパフォーマンスのために重ね合わせた局所的なヒストグラムの正規化を使用しています。信頼性の高い結果が得られることが証明されていますが、計算の複雑さのために時間がかかる傾向があります。

Ferrari ら[4]は，2 値エッジ画像の物体境界に非剛体形状マッチャを用いたハフ方式の投票方式を用いて物体を認識する学習ベースの手法を提供している．このアプローチでは，統計的手法を用いて，物体の周囲の境界ボックス内でのみ拘束された少数の画像からモデルを学習する．このアプローチは非常に良好なクラス分類結果を得ることができますが、計算コストが高いためリアルタイムでの物体追跡には適しておらず、また、物体の正確なポーズを返すのに十分な精度を持っていません。さらに、以前に議論した問題であるバイナリエッジ検出器の結果に敏感です。

Kalal ら[20]は最近，オンライン学習ベースのアプローチを開発した．彼らは、自動的に生成された訓練セットを用いて、リアルタイムにオンラインで分類器を訓練する方法を示した。しかし，実験で見られるように，このアプローチは滑らかな背景の遷移にのみ適しており，未知の背景の上にある既知の物体を検出するのには適していない．
